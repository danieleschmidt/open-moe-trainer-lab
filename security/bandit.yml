# Bandit configuration for Open MoE Trainer Lab
# https://bandit.readthedocs.io/en/latest/config.html

# Tests to skip
skips:
  # B101: assert_used - Allow assert statements in tests
  - B101
  # B601: paramiko_calls - We don't use paramiko
  - B601
  # B602: subprocess_popen_with_shell_equals_true - We control shell usage
  - B602

# Tests to exclude from specific paths
exclude_dirs:
  - '/tests'
  - '/docs'
  - '/examples'
  - '/.git'
  - '/.pytest_cache'
  - '/__pycache__'
  - '/wandb'
  - '/checkpoints'

# Files to exclude
exclude:
  - '*/test_*.py'
  - '*_test.py'
  - 'conftest.py'

# Severity levels: LOW, MEDIUM, HIGH
# Confidence levels: LOW, MEDIUM, HIGH

# Only report issues with medium confidence or higher
confidence: 
  - MEDIUM
  - HIGH

# Report all severity levels
severity:
  - LOW
  - MEDIUM
  - HIGH

# Custom test configurations
tests:
  # B102: exec_used
  B102:
    severity: HIGH
    confidence: HIGH
    
  # B103: set_bad_file_permissions
  B103:
    severity: MEDIUM
    confidence: HIGH
    
  # B104: hardcoded_bind_all_interfaces
  B104:
    severity: MEDIUM
    confidence: MEDIUM
    
  # B105: hardcoded_password_string
  B105:
    severity: HIGH
    confidence: MEDIUM
    
  # B106: hardcoded_password_funcarg
  B106:
    severity: HIGH
    confidence: MEDIUM
    
  # B107: hardcoded_password_default
  B107:
    severity: HIGH
    confidence: MEDIUM
    
  # B108: hardcoded_tmp_directory
  B108:
    severity: MEDIUM
    confidence: MEDIUM
    
  # B110: try_except_pass
  B110:
    severity: LOW
    confidence: HIGH
    
  # B112: try_except_continue
  B112:
    severity: LOW
    confidence: HIGH
    
  # B201: flask_debug_true
  B201:
    severity: HIGH
    confidence: HIGH
    
  # B301: pickle
  B301:
    severity: MEDIUM
    confidence: HIGH
    
  # B302: marshal
  B302:
    severity: MEDIUM
    confidence: HIGH
    
  # B303: md5
  B303:
    severity: MEDIUM
    confidence: HIGH
    
  # B304: des
  B304:
    severity: HIGH
    confidence: HIGH
    
  # B305: cipher
  B305:
    severity: HIGH
    confidence: HIGH
    
  # B306: mktemp_q
  B306:
    severity: MEDIUM
    confidence: HIGH
    
  # B307: eval
  B307:
    severity: HIGH
    confidence: HIGH
    
  # B308: mark_safe
  B308:
    severity: MEDIUM
    confidence: HIGH
    
  # B309: httpsconnection
  B309:
    severity: MEDIUM
    confidence: HIGH
    
  # B310: urllib_urlopen
  B310:
    severity: MEDIUM
    confidence: HIGH
    
  # B311: random
  B311:
    severity: LOW
    confidence: HIGH
    
  # B312: telnetlib
  B312:
    severity: HIGH
    confidence: HIGH
    
  # B313: xml_bad_cElementTree
  B313:
    severity: MEDIUM
    confidence: HIGH
    
  # B314: xml_bad_ElementTree
  B314:
    severity: MEDIUM
    confidence: HIGH
    
  # B315: xml_bad_expatreader
  B315:
    severity: MEDIUM
    confidence: HIGH
    
  # B316: xml_bad_expatbuilder
  B316:
    severity: MEDIUM
    confidence: HIGH
    
  # B317: xml_bad_sax
  B317:
    severity: MEDIUM
    confidence: HIGH
    
  # B318: xml_bad_minidom
  B318:
    severity: MEDIUM
    confidence: HIGH
    
  # B319: xml_bad_pulldom
  B319:
    severity: MEDIUM
    confidence: HIGH
    
  # B320: xml_bad_etree
  B320:
    severity: MEDIUM
    confidence: HIGH
    
  # B321: ftplib
  B321:
    severity: HIGH
    confidence: HIGH
    
  # B322: input
  B322:
    severity: HIGH
    confidence: HIGH
    
  # B323: unverified_context
  B323:
    severity: HIGH
    confidence: HIGH
    
  # B324: hashlib_new_insecure_functions
  B324:
    severity: MEDIUM
    confidence: HIGH
    
  # B325: tempnam
  B325:
    severity: HIGH
    confidence: HIGH
    
  # B401: import_telnetlib
  B401:
    severity: HIGH
    confidence: HIGH
    
  # B402: import_ftplib
  B402:
    severity: HIGH
    confidence: HIGH
    
  # B403: import_pickle
  B403:
    severity: LOW
    confidence: HIGH
    
  # B404: import_subprocess
  B404:
    severity: LOW
    confidence: HIGH
    
  # B405: import_xml_etree
  B405:
    severity: LOW
    confidence: HIGH
    
  # B406: import_xml_sax
  B406:
    severity: LOW
    confidence: HIGH
    
  # B407: import_xml_expat
  B407:
    severity: LOW
    confidence: HIGH
    
  # B408: import_xml_minidom
  B408:
    severity: LOW
    confidence: HIGH
    
  # B409: import_xml_pulldom
  B409:
    severity: LOW
    confidence: HIGH
    
  # B410: import_lxml
  B410:
    severity: LOW
    confidence: HIGH
    
  # B411: import_xmlrpclib
  B411:
    severity: HIGH
    confidence: HIGH
    
  # B412: import_httpoxy
  B412:
    severity: HIGH
    confidence: HIGH
    
  # B501: request_with_no_cert_validation
  B501:
    severity: HIGH
    confidence: HIGH
    
  # B502: ssl_with_bad_version
  B502:
    severity: HIGH
    confidence: HIGH
    
  # B503: ssl_with_bad_defaults
  B503:
    severity: MEDIUM
    confidence: HIGH
    
  # B504: ssl_with_no_version
  B504:
    severity: HIGH
    confidence: HIGH
    
  # B505: weak_cryptographic_key
  B505:
    severity: HIGH
    confidence: HIGH
    
  # B506: yaml_load
  B506:
    severity: MEDIUM
    confidence: HIGH
    
  # B507: ssh_no_host_key_verification
  B507:
    severity: HIGH
    confidence: HIGH
    
  # B601: paramiko_calls
  B601:
    severity: MEDIUM
    confidence: HIGH
    
  # B602: subprocess_popen_with_shell_equals_true
  B602:
    severity: HIGH
    confidence: HIGH
    
  # B603: subprocess_without_shell_equals_true
  B603:
    severity: LOW
    confidence: HIGH
    
  # B604: any_other_function_with_shell_equals_true
  B604:
    severity: HIGH
    confidence: HIGH
    
  # B605: start_process_with_a_shell
  B605:
    severity: HIGH
    confidence: HIGH
    
  # B606: start_process_with_no_shell
  B606:
    severity: LOW
    confidence: HIGH
    
  # B607: start_process_with_partial_path
  B607:
    severity: LOW
    confidence: HIGH
    
  # B608: hardcoded_sql_expressions
  B608:
    severity: MEDIUM
    confidence: HIGH
    
  # B609: linux_commands_wildcard_injection
  B609:
    severity: HIGH
    confidence: HIGH
    
  # B610: django_extra_used
  B610:
    severity: MEDIUM
    confidence: HIGH
    
  # B611: django_rawsql_used
  B611:
    severity: MEDIUM
    confidence: HIGH
    
  # B701: jinja2_autoescape_false
  B701:
    severity: HIGH
    confidence: HIGH
    
  # B702: use_of_mako_templates
  B702:
    severity: MEDIUM
    confidence: HIGH
    
  # B703: django_mark_safe
  B703:
    severity: MEDIUM
    confidence: HIGH